{% extends 'admin.html' %}
{% block content %}

<div class="container col-md-8 col-lg-6 border border-2 rounded-4 p-4 bg-white mt-5">
  <h2 class="mb-4 mt-2 fw-bold">Update Item</h2>
    {% if item.get('sizes') %}
    <form method="POST" action="{{ url_for('item.confirm_update', itemCode=size_data.itemCode) }}">
    {% else %}
        <form method="POST" action="{{ url_for('item.confirm_update', itemCode=item['itemCode']) }}">
    {% endif %}
        <div class="mb-4"> 
        <p><strong>Item:</strong> {{ item['item_name'] }}</p>
        <p><strong>Category:</strong> {{ item['item_category'] }}</p>
    
        {% if item.get('sizes') %}
            <p><strong>Size:</strong> {{ size_data.size }}</p>
            <p><strong>Current Quantity:</strong> {{ size_data.quantity }}</p>
            <p><strong>Current Price:</strong> {{ size_data.price }}</p>
            <input type="hidden" name="size" value="{{ size_data.size }}">
        {% else %}
            <p><strong>Current Quantity:</strong> {{ item['item_quantity'] }}</p>
            <p><strong>Current Price:</strong> {{ item['item_price'] }}</p>
            <input type="hidden" name="size" value="None">
        {% endif %}
        </div>   
        <div class="mb-4 row align-items-center" style="max-width: 450px;">
        <label for="reference_number" class="col-auto fw-bold mb-0 me-3">Reference Number:</label>
        <div class="col">
          <input id="refnum" class="form-control" type="text" name="refnum" placeholder="Reference Number"/>
        </div>
        </div>
       <div class="mb-3">
  <label for="action" class="form-label fw-bold">Action</label>
  <select class="form-select w-75" name="action" id="action" required>
    <option value="" selected disabled>-- Select Action --</option>
    <option value="restock">Restock</option>
    <option value="deduct">Deduct</option>
    <option value="price">Update Price</option>
  </select>
</div>

<div class="mb-3 d-none" id="quantity_input">
  <label for="new_quantity" class="form-label fw-bold">New Quantity</label>
  <input type="number" class="form-control w-75" name="new_quantity" id="new_quantity" placeholder="Enter new quantity">
</div>

<div class="mb-3 d-none" id="price_input">
  <label for="new_price" class="form-label fw-bold">New Price</label>
  <input type="number" class="form-control w-75" name="price" id="new_price" placeholder="Enter new price">
</div>

<div class="mb-3 d-none" id="reason_input">
  <label for="reason" class="form-label fw-bold">Reason</label>
  <input type="text" class="form-control w-75" name="reason" id="reason" placeholder="Enter reason">
</div>
  <div class="mt-3">
    <button type="submit" class="btn btn-primary w-75">Submit</button>
  </div>
</form>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const actionSelect = document.getElementById('action');
    const quantityInput = document.getElementById('quantity_input');
    const priceInput = document.getElementById('price_input');
    const reasonInput = document.getElementById('reason_input');
    const qtyField = document.getElementById('new_quantity');
    const priceField = document.getElementById('new_price');
    const reasonField = document.getElementById('reason');

    function resetFields() {
        quantityInput.classList.add('d-none');
        priceInput.classList.add('d-none');
        reasonInput.classList.add('d-none');
        qtyField.removeAttribute('required');
        priceField.removeAttribute('required');
        reasonField.removeAttribute('required');
    }

    actionSelect.addEventListener('change', function () {
        resetFields();
        switch (this.value) {
            case 'restock':
                quantityInput.classList.remove('d-none');
                qtyField.setAttribute('required', 'required');
                break;
            case 'deduct':
                quantityInput.classList.remove('d-none');
                reasonInput.classList.remove('d-none');
                qtyField.setAttribute('required', 'required');
                reasonField.setAttribute('required', 'required');
                break;
            case 'price':
                priceInput.classList.remove('d-none');
                priceField.setAttribute('required', 'required');
                break;
        }
    });
});
</script>
{% endblock %}

