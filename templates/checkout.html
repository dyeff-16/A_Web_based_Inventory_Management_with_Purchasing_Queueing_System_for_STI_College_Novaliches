{% extends "index.html" %}
{% block content %}
<div class="checkout-container">
    <h1>Checkout Summary</h1>

    {% if items %}
        <ul>
            {% for item in items %}
                <li class="checkout-item">
                    <img src="data:image/jpeg;base64,{{ item.image }}" width="100">
                    <div>
                        <h3>{{ item.item_name }}</h3>
                        <p>Price: ₱ {{ item.item_price }}</p>
                        {% if item.size %}
                            <p>Size: {{ item.size }}</p>
                        {% endif %}
                        <p>Quantity: {{ item.item_quantity }}</p>
                        <p>Total: ₱ {{ item.total_amount }}</p>
                    </div>
                </li>
            {% endfor %}
        </ul>

        <div class="checkout-total">
            <h2>Total Amount: ₱ {{ total }}</h2>
        </div>

        <form id="checkoutForm" action="{{ url_for('checkout.place_order') }}" method="POST">
            {% for item in items %}
                <input type="hidden" name="selected_items" value="{{ item.itemCode }}">
            {% endfor %}
        
            <button type="button" class="btn" onclick="showConfirmationModal()">Confirm Order</button>
        </form>

    {% else %}
        <p>No items selected for checkout.</p>
    {% endif %}
</div>

<!-- Confirmation Modal -->
<div id="confirmationModal" class="confirm_modal">
    <div class="modal-content_confirm">
        <span class="close" onclick="closeConfirmationModal()">&times;</span>
        <h2>Are you sure you want to place this order?</h2>
        <button class="btn confirm-btn" onclick="confirmOrder()">Yes</button>
        <button class="btn cancel-btn" onclick="closeConfirmationModal()">No</button>
    </div>
</div>

<!-- Modal Styles -->
<style>
    /* Modal Styles */
    .confirm_modal {
        display: none; 
        position: fixed; 
        z-index: 1; 
        left: 0;
        top: 0;
        width: 100%; 
        height: 100%;
        background-color: rgba(0,0,0,0.4); 
        overflow: auto; 
        padding-top: 60px; 
    }
    .modal-content_confirm{
        background-color: #fefefe;
        margin: 200px auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%; 
        max-width: 400px;
        text-align: center;
    }

    .close {
        color: #aaa;
        font-size: 28px;
        font-weight: bold;
        position: absolute;
        top: 0;
        right: 10px;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    .btn {
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
        margin: 10px;
    }

    .btn.cancel-btn {
        background-color: #f44336;
    }

    .btn:hover {
        opacity: 0.8;
    }
</style>

<script>
    // Show the confirmation modal
    function showConfirmationModal() {
        document.getElementById("confirmationModal").style.display = "block";
    }

    // Close the confirmation modal
    function closeConfirmationModal() {
        document.getElementById("confirmationModal").style.display = "none";
    }

    // Confirm the order and submit the form
    function confirmOrder() {
        document.getElementById("checkoutForm").submit();
    }
</script>
{% endblock %}
