{% extends "index.html" %}
{% block content %}
 <div class="container my-5">

    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h2 class="mb-1"><i class="bi bi-cart3 text-primary me-2"></i>Your Cart</h2>
      </div>
      <a href="{{url_for('cart.preOrder')}}" class="btn btn-outline-danger">
        <i class="bi bi-heart-fill me-1"></i>Pre-order
      </a>
    </div>
    <!-- <h1 class="mb-4 text-primary fw-bold">Your Cart</h1>
    <a href="{{url_for('cart.preOrder')}}" class="bi bi-heart-fill text-danger fs-3"></a> -->

    {% if cart_items %}
    <form method="POST" action="{{ url_for('checkout.check_out') }}">
      <div class="row g-4">
        <!--Cart Item Colum-->
        <div class="col-lg-8">
          
          <!-- Loop through cart itemss -->
          {% for item in cart_items %}
          <div class="card cart-item-card shadow-sm mb-3">
            <div class="card-body">
              <div class="row align-items-center">
                <div class="col-auto">
                  <div class="form-check me-3">
                    <input type="checkbox" name="selected_items" value="{{ item.itemCode }}"
                      class="form-check-input select-item" data-price="{{ item.total_amount }}"
                      onchange="updateTotal()">
                  </div>
                </div>

                <div class="col-auto">
                  <img src="data:image/jpeg;base64,{{ item.image }}" class="img-thumbnail me-3"
                    alt="{{ item.item_name }}"
                    style="width: 120px; height: 120px; object-fit: cover; border-radius: 0.5rem;">
                </div>

                <div class="col">
                  <h5 class="mb-2">{{ item.item_name }}</h5>
                  <p class="text-primary fw-bold mb-2">₱ {{ item.item_price }}</p>

                  {% if item.size %}
                  <p class="mb-2 text-muted"><strong>Size: {{ item.size }}</strong></p>
                  {% endif %}

                  <div class="d-inline-flex align-items-center gap-2">
                    <span class="text-muted small">Quantity:</span>
                    <a onclick="stockButton('minus', '{{item.itemCode}}', '{{item.item_id}}', event)"
                      class="btn btn-sm btn-outline-secondary quantity-btn"><i class="bi bi-dash"></i></a>
                    <span id="getCartItem_{{item.item_id}}" class="fw-bold mx-2">{{item.item_quantity}}</span>
                    <a onclick="stockButton('add', '{{item.itemCode}}', '{{item.item_id}}', event)"
                      class="btn btn-sm btn-outline-secondary quantity-btn"><i class="bi bi-plus"></i></a>
                  </div>

                  <p class="mt-2 mb-0">
                    <strong>Total:</strong>
                    <span class="text-primary fw-bold">₱ {{ item.total_amount }}</span>
                  </p>
                </div>

                <!--href="{{ url_for('cart.update_quantity', item_id=item.item_id, item_code=item.itemCode, item_quantity=item.item_quantity - 1) }}-->

                <div class="col-auto">
                  <a href="{{ url_for('cart.remove_from_cart', item_id=item.item_id, item_code=item.itemCode, item_category=item.item_category) }}"
                    class="btn btn-outline-danger btn-sm"><i class="bi bi-trash me-1"></i>Remove</a>
                </div>
              </div>
            </div>
          </div>
          <!-- Empty Cart State (hidden when items exist) -->
          <!-- <div class="card shadow-sm" style="display: none;">
                  <div class="card-body text-center py-5">
                    <i class="bi bi-cart-x fs-1 text-muted mb-3 d-block"></i>
                      <h5 class="text-muted">Your cart is empty</h5>
                        <p class="text-muted mb-4">Add some items to get started!</p>
                          <a href="#" class="btn btn-primary">
                            <i class="bi bi-shop me-2"></i>Continue Shopping
                          </a>
                  </div>
                </div> -->
          {% endfor %}
        </div>

        <!-- Summary Column -->
        <div class="col-lg-4">
          <div class="card shadow-sm sticky-top" style="top: 20px;">
            <div class="card-body">
              <h5 class="mb-3"><i class="bi bi-receipt me-2"></i>Order Summary</h5>

              <div class="d-flex justify-content-between mb-2">
                <h5 class="mb-0">Total:</h5>
                <h5 class="mb-0 text-primary" id="selected-total">₱ 0.00</h5>
              </div>

              <button type="submit" class="btn btn-primary w-100 btn-lg">
                <i class="bi bi-credit-card me-2"></i>Proceed to Checkout
              </button>

              <div class="mt-3 text-center">
                <a href="product.html" class="text-decoration-none">
                  <i class="bi bi-arrow-left me-1"></i> Continue Shopping
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>
    {% else %}
    <div class="alert alert-info mt-4">Your cart is empty.</div>
    {% endif %}
    <!-- Mobile Checkout Bar (visible on small screens) -->
    <!-- <div class="checkout-bar fixed-bottom d-lg-none">
        <div class="container py-3">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <small class="text-muted d-block">Total</small>
                    <h5 class="mb-0 text-primary">₱0.00</h5>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-credit-card me-1"></i>Checkout
                </button>
            </div>
        </div>
    </div>
  </div> -->


  <script src="/static/cart.js"></script>
<style>
  .cart-item-card {
    transition: all 0.3s ease;
    border: 2px solid transparent;
  }

  .cart-item-card:hover {
    border-color: #0d6efd;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .cart-item-card.selected {
    border-color: #0d6efd;
    background: #f8f9ff;
  }

  .quantity-control {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .quantity-btn {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
  }

  .checkout-bar {
    background: white;
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
  }
</style>

{% endblock %}